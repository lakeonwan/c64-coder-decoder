90 REM de(coder) voor cbm 64
91 REM source code from Dutch Eppo magazine Handboek Spion deel 1 (1985)
100 DIM L(80)
110 PRINT"TYP SLEUTEL (TUSSEN 1 EN 25)";
120 INPUT S
130 IF S<1 OR S>25 THEN 110
140 PRINT "TYP TEKST (MAXIMAAL TWEE REGELS)"
150 INPUT C$
160 Y=LEN(C$)
170 FOR X=1 TO Y
180  L$=LEFT$(C$,1)
190  C$=RIGHT$(C$, (Y-X))
200  L(X)=ASC(L$)
210 NEXT X
220 PRINT"CODEREN OF DECODEREN (C/D)";
230 INPUT A$
240 IF A$="D" THEN 340
250 FOR X=1 TO Y STEP 2
260  IF L(X)=32 THEN 290
270  L(X)=L(X)+S
280  IF L(X)>90 THEN L(X)=L(X)-26
290  IF L(X+1)=32 THEN 320
300  L(X+1)=L(X+1)-S
310  IF L(X+1)<65 THEN L(X+1)=L(X+1)+26
320 NEXT X
330 GOTO 420
340 FOR X=1 TO Y STEP 2
350  IF L(X)=32 THEN 380
360  L(X)=L(X)-S
370  IF L(X)<65 THEN L(X)=L(X)+26
380  IF L(X+1)=32 THEN 410
390  L(X+1)=L(X+1)+S
400  IF L(X+1)>90 THEN L(X+1)=L(X+1)-26
410 NEXT X
420 FOR X=1 TO Y
430  PRINT CHR$(L(X));
440 NEXT X
